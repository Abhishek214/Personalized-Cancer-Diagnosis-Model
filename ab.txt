from PIL import Image
import numpy as np

if new_w != old_w or new_h != old_h:
    # Convert float64 to uint8 (0-255 range)
    if image.dtype == np.float64 or image.dtype == np.float32:
        # Normalize to 0-1 range first, then scale to 0-255
        image_normalized = (image - image.min()) / (image.max() - image.min())
        image_uint8 = (image_normalized * 255).astype(np.uint8)
    else:
        image_uint8 = image.astype(np.uint8)
    
    pil_image = Image.fromarray(image_uint8)
    
    if interpolation is None:
        resized_pil = pil_image.resize((new_w, new_h))
    else:
        resized_pil = pil_image.resize((new_w, new_h), interpolation)
    
    # Convert back to original dtype if needed
    image = np.array(resized_pil).astype(image.dtype)
